{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createTextVNode as _createTextVNode, toDisplayString as _toDisplayString, vShow as _vShow, withDirectives as _withDirectives, Fragment as _Fragment, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"contents\"\n};\nconst _hoisted_2 = {\n  class: \"content_box\"\n};\nconst _hoisted_3 = {\n  class: \"alarm\"\n};\nconst _hoisted_4 = {\n  class: \"header_tab\"\n};\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"a\", {\n  href: \"#this\"\n}, \"AI 무출동 대상 조회\", -1 /* HOISTED */);\nconst _hoisted_6 = [_hoisted_5];\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"a\", {\n  href: \"#this\"\n}, \"알림톡 발송 이력\", -1 /* HOISTED */);\nconst _hoisted_8 = [_hoisted_7];\nconst _hoisted_9 = {\n  class: \"layer_popup\"\n};\nconst _hoisted_10 = {\n  class: \"alarm_box\"\n};\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"h1\", null, \"알림톡 발송 정보 입력\", -1 /* HOISTED */);\nconst _hoisted_12 = {\n  class: \"layer_box\"\n};\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"p\", {\n  class: \"fc_st02\"\n}, [/*#__PURE__*/_createTextVNode(\"고장 접수된 고객명과 전화번호로 발송 가능하니\"), /*#__PURE__*/_createElementVNode(\"br\"), /*#__PURE__*/_createTextVNode(\"발송시 유의해 주시기 바랍니다.\")], -1 /* HOISTED */);\nconst _hoisted_14 = {\n  class: \"dl_st_01\"\n};\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"dt\", null, [/*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"user_id\"\n}, \"고객명\")], -1 /* HOISTED */);\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"input\", {\n  type: \"text\",\n  class: \"input_st_01\",\n  id: \"targetName\",\n  placeholder: \"고객명\",\n  value: \"\",\n  disabled: \"\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_17 = {\n  class: \"input_ctl\"\n};\nconst _hoisted_18 = /*#__PURE__*/_createElementVNode(\"dt\", null, [/*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"user_pw\"\n}, \"전화번호\")], -1 /* HOISTED */);\nconst _hoisted_19 = /*#__PURE__*/_createElementVNode(\"input\", {\n  type: \"text\",\n  class: \"input_st_01\",\n  id: \"targetNum\",\n  placeholder: \"전화번호\",\n  value: \"\",\n  disabled: \"\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_20 = {\n  class: \"input_ctl\"\n};\nconst _hoisted_21 = {\n  class: \"error_txt\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_alarm_n_a_tartget_list = _resolveComponent(\"alarm-n-a-tartget-list\");\n  const _component_alarm_send_hist_list = _resolveComponent(\"alarm-send-hist-list\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createCommentVNode(\" ct_03:인증 \"), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"ul\", null, [_createElementVNode(\"li\", {\n    class: _normalizeClass($data.tabNum == 1 ? 'on' : ''),\n    onClick: _cache[0] || (_cache[0] = $event => $options.setMenuOnToggle(1))\n  }, _hoisted_6, 2 /* CLASS */), _createElementVNode(\"li\", {\n    class: _normalizeClass($data.tabNum == 2 ? 'on' : ''),\n    onClick: _cache[1] || (_cache[1] = $event => $options.setMenuOnToggle(2))\n  }, _hoisted_8, 2 /* CLASS */)])]), _createElementVNode(\"div\", null, [$data.tabNum == 1 ? (_openBlock(), _createBlock(_component_alarm_n_a_tartget_list, {\n    key: 0,\n    onOpenLayerPop: $options.openLayerPop\n  }, null, 8 /* PROPS */, [\"onOpenLayerPop\"])) : _createCommentVNode(\"v-if\", true), $data.tabNum == 2 ? (_openBlock(), _createBlock(_component_alarm_send_hist_list, {\n    key: 1,\n    onOpenLayerPop: $options.openLayerPop\n  }, null, 8 /* PROPS */, [\"onOpenLayerPop\"])) : _createCommentVNode(\"v-if\", true)]), _createCommentVNode(\"// group \")])])]), _withDirectives(_createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"div\", _hoisted_10, [_hoisted_11, _createElementVNode(\"div\", _hoisted_12, [_hoisted_13, _createElementVNode(\"dl\", _hoisted_14, [_hoisted_15, _createElementVNode(\"dd\", null, [_hoisted_16, _createElementVNode(\"div\", _hoisted_17, [_createElementVNode(\"span\", {\n    class: \"modify\",\n    onClick: _cache[2] || (_cache[2] = $event => $options.inputModify('targetName'))\n  }, \"수정\")])])]), _createElementVNode(\"dl\", null, [_hoisted_18, _createElementVNode(\"dd\", null, [_hoisted_19, _createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"span\", {\n    class: \"modify\",\n    onClick: _cache[3] || (_cache[3] = $event => $options.inputModify('targetNum'))\n  }, \"수정\")])])]), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = $event => $options.sendAlarmTalk())\n  }, \"알림톡 발송\"), _createElementVNode(\"p\", _hoisted_21, _toDisplayString($data.errorTxt), 1 /* TEXT */)]), _createElementVNode(\"p\", {\n    class: \"layer_close\",\n    onClick: _cache[5] || (_cache[5] = $event => $options.closeLayerPopup())\n  })])], 512 /* NEED_PATCH */), [[_vShow, $data.onLayer]])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"mappings":";;EAEOA,KAAK,EAAC;AAAU;;EACdA,KAAK,EAAC;AAAa;;EACjBA,KAAK,EAAC;AAAO;;EACXA,KAAK,EAAC;AAAY;gCAE8CC,oBAAgC;EAA7BC,IAAI,EAAC;AAAO,GAAC,cAAY;oBAA5BC,UAAgC;gCAChCF,oBAA6B;EAA1BC,IAAI,EAAC;AAAO,GAAC,WAAS;oBAAzBE,UAA6B;;EAWnGJ,KAAK,EAAC;AAAa;;EACjBA,KAAK,EAAC;AAAW;iCACpBC,oBAAqB,YAAjB,cAAY;;EACXD,KAAK,EAAC;AAAW;iCACpBC,oBAAqE;EAAlED,KAAK,EAAC;AAAS,kCAAC,2BAAyB,oCAAI,wDAAiB;;EAC7DA,KAAK,EAAC;AAAU;iCAClBC,oBAAyC,0BAArCA,oBAAgC;EAAzBI,GAAG,EAAC;AAAS,GAAC,KAAG;iCAE1BJ,oBAA2F;EAApFK,IAAI,EAAC,MAAM;EAACN,KAAK,EAAC,aAAa;EAACO,EAAE,EAAC,YAAY;EAACC,WAAW,EAAC,KAAK;EAACC,KAAK,EAAC,EAAE;EAACC,QAAQ,EAAR;;;EAC7EV,KAAK,EAAC;AAAW;iCAMxBC,oBAA0C,0BAAtCA,oBAAiC;EAA1BI,GAAG,EAAC;AAAS,GAAC,MAAI;iCAE3BJ,oBAA4F;EAArFK,IAAI,EAAC,MAAM;EAAEN,KAAK,EAAC,aAAa;EAACO,EAAE,EAAC,WAAW;EAACC,WAAW,EAAC,MAAM;EAACC,KAAK,EAAC,EAAE;EAACC,QAAQ,EAAR;;;EAC9EV,KAAK,EAAC;AAAW;;EAMvBA,KAAK,EAAC;AAAW;;;;6DA1CxBW,iCAAiB,EACnBV,oBAgBM,OAhBNW,UAgBM,GAfJX,oBAcM,OAdNY,UAcM,GAbJZ,oBAYM,OAZNa,UAYM,GAXJb,oBAKM,OALNc,UAKM,GAJJd,oBAGK,aAFHA,oBAAsG;IAAjGD,KAAK,kBAAEgB,YAAM;IAAoBC,OAAK,sCAAEC,wBAAe;iCAC5DjB,oBAAmG;IAA9FD,KAAK,kBAAEgB,YAAM;IAAoBC,OAAK,sCAAEC,wBAAe;qCAGhEjB,oBAGM,cAFuDe,YAAM,uBAAjEG,aAA0EC;;IAAjDC,cAAY,EAAEH;oFACkBF,YAAM,uBAA/DG,aAAwEG;;IAAjDD,cAAY,EAAEH;sFAEvCP,gCAAgB,wBAItBV,oBA4BM,OA5BNsB,UA4BM,GA3BJtB,oBA0BM,OA1BNuB,WA0BM,GAzBJC,WAAqB,EACrBxB,oBAsBM,OAtBNyB,WAsBM,GArBJC,WAAqE,EACrE1B,oBAQK,MARL2B,WAQK,GAPHC,WAAyC,EACzC5B,oBAKK,aAJH6B,WAA2F,EAC3F7B,oBAEM,OAFN8B,WAEM,GADJ9B,oBAAiE;IAA3DD,KAAK,EAAC,QAAQ;IAAEiB,OAAK,sCAAEC,oBAAW;KAAgB,IAAE,SAIhEjB,oBAQK,aAPH+B,WAA0C,EAC1C/B,oBAKK,aAJHgC,WAA4F,EAC5FhC,oBAEM,OAFNiC,WAEM,GADJjC,oBAAgE;IAA1DD,KAAK,EAAC,QAAQ;IAAEiB,OAAK,sCAAEC,oBAAW;KAAe,IAAE,SAI/DjB,oBAAgD;IAAvCgB,OAAK,sCAAEC,sBAAa;KAAI,QAAM,GACvCjB,oBAAqC,KAArCkC,WAAqC,mBAAdnB,cAAQ,oBAEjCf,oBAAsD;IAAnDD,KAAK,EAAC,aAAa;IAAEiB,OAAK,sCAAEC,wBAAe;0CA1BjBF,aAAO","names":["class","_createElementVNode","href","_hoisted_5","_hoisted_7","for","type","id","placeholder","value","disabled","_createCommentVNode","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","$data","onClick","$options","_createBlock","_component_alarm_n_a_tartget_list","onOpenLayerPop","_component_alarm_send_hist_list","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21"],"sourceRoot":"","sources":["C:\\CSAI_Front\\src\\views\\pages\\alarm\\Alarm.vue"],"sourcesContent":["<template>\r\n    <!-- ct_03:인증 -->\r\n  <div class=\"contents\">\r\n    <div class=\"content_box\">\r\n      <div class=\"alarm\">\r\n        <div class=\"header_tab\">\r\n          <ul>\r\n            <li :class=\"tabNum == 1 ? 'on' : ''\" @click=\"setMenuOnToggle(1)\"><a href=\"#this\">AI 무출동 대상 조회</a></li>\r\n            <li :class=\"tabNum == 2 ? 'on' : ''\" @click=\"setMenuOnToggle(2)\"><a href=\"#this\">알림톡 발송 이력</a></li>\r\n          </ul>\r\n        </div>\r\n        <div>\r\n          <alarm-n-a-tartget-list @openLayerPop=\"openLayerPop\" v-if=\"tabNum == 1\" />\r\n          <alarm-send-hist-list @openLayerPop=\"openLayerPop\" v-if=\"tabNum == 2\" />\r\n        </div>\r\n        <!--// group -->\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"layer_popup\" v-show=\"onLayer\">\r\n    <div class=\"alarm_box\">\r\n      <h1>알림톡 발송 정보 입력</h1>\r\n      <div class=\"layer_box\">\r\n        <p class=\"fc_st02\">고장 접수된 고객명과 전화번호로 발송 가능하니<br>발송시 유의해 주시기 바랍니다.</p>\r\n        <dl class=\"dl_st_01\">\r\n          <dt><label for=\"user_id\">고객명</label></dt>\r\n          <dd>\r\n            <input type=\"text\" class=\"input_st_01\" id=\"targetName\" placeholder=\"고객명\" value=\"\" disabled>\r\n            <div class=\"input_ctl\">\r\n              <span class=\"modify\" @click=\"inputModify('targetName')\">수정</span>\r\n            </div>\r\n          </dd>\r\n        </dl>\r\n        <dl>\r\n          <dt><label for=\"user_pw\">전화번호</label></dt>\r\n          <dd>\r\n            <input type=\"text\"  class=\"input_st_01\" id=\"targetNum\" placeholder=\"전화번호\" value=\"\" disabled>\r\n            <div class=\"input_ctl\">\r\n              <span class=\"modify\" @click=\"inputModify('targetNum')\">수정</span>\r\n            </div>\r\n          </dd>\r\n        </dl>\r\n        <button @click=\"sendAlarmTalk()\">알림톡 발송</button>\r\n        <p class=\"error_txt\">{{errorTxt}}</p>\r\n      </div>\r\n      <p class=\"layer_close\" @click=\"closeLayerPopup()\"></p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import AlarmNATartgetList from './AlarmNATartgetList.vue'; // AI 무출동 대상 조회\r\n  import AlarmSendHistList from './AlarmSendHistList.vue'; // 알림톡 발송 이력\r\n  import StringUtil from '../../../utils/StringUtil';\r\n\r\n  export default {\r\n    name: 'App',\r\n    data() {\r\n      return {\r\n        testPageNum : 1,\r\n        onLayer : false,\r\n        tabNum : 1,\r\n        errorTxt : \"\",\r\n        ttId : \"\",\r\n        svcMainClsCode : \"\",\r\n        sndNm : \"\",\r\n        sndTeam : \"\",\r\n        custNm : \"\",\r\n        custTelNo : \"\",\r\n        oriCustNm : \"\",\r\n        oriCustTelNo : \"\"\r\n      }\r\n    },\r\n    components: {\r\n      AlarmNATartgetList, // AI 무출동 대상 조회\r\n      AlarmSendHistList, // 알림톡 발송 이력\r\n    },\r\n    computed: {\r\n      roomInfo() {\r\n        return this.$store.state.kakao.roomInfo;\r\n      },\r\n      userInfo() {\r\n      // 로그인 사용자 정보\r\n        return this.$store.state.auth.userInfo;\r\n      },\r\n      consultTarget() {\r\n      // 로그인 사용자 정보\r\n        return this.$store.state.consult.consultTarget;\r\n      },\r\n      renewalToken(){\r\n        return this.$store.state.auth.renewalToken;\r\n      }\r\n    },\r\n    created() {\r\n    },\r\n    methods: {\r\n      setTestPageNum() {\r\n        this.testPageNum = this.testPageNum + 1;\r\n      },\r\n      openLayerPop(item){\r\n                \r\n        this.onLayer = true;\r\n        let userInfoData = this.userInfo;  // 로그인한 사용자 정보        \r\n        let custName = '';\r\n        let reporterTelNum1 = '';\r\n        let reporterTelNum2 = '';\r\n        let telNum = '';\r\n        let ttId = '';\r\n        let svcMainClsCode = '';\r\n        let sndNm = '';\r\n        let sndTeam = '';\r\n        let tabNum = this.tabNum;        \r\n        // 무출동 대상조회\r\n        if(tabNum == 1){\r\n          custName = item.custName;\r\n          reporterTelNum1 = item.reporterTelNum1;\r\n          reporterTelNum2 = item.reporterTelNum2;\r\n          telNum = '';\r\n          ttId = item.ttId;\r\n          svcMainClsCode = item.svcMainClsCode;\r\n          sndNm = userInfoData.userName;   \r\n          sndTeam = userInfoData.deptName;\r\n          if(reporterTelNum1 != \"\"){                                \r\n            if(reporterTelNum1.indexOf(\"010\") == 0 || reporterTelNum1.indexOf(\"010\") == 1 || \r\n                reporterTelNum1.indexOf(\"017\") == 0 || reporterTelNum1.indexOf(\"017\") == 1 ||\r\n                reporterTelNum1.indexOf(\"016\") == 0 || reporterTelNum1.indexOf(\"016\") == 1 ||\r\n                reporterTelNum1.indexOf(\"011\") == 0 || reporterTelNum1.indexOf(\"011\") == 1){                  \r\n              telNum = reporterTelNum1;\r\n            } else {\r\n              telNum = reporterTelNum2;                             \r\n            }\r\n          } else {\r\n            telNum = reporterTelNum2;                        \r\n          }\r\n          \r\n          if(telNum.indexOf(\"010\") != 0 && telNum.indexOf(\"010\") != 1 &&\r\n              telNum.indexOf(\"017\") != 0 && telNum.indexOf(\"017\") != 1 &&\r\n              telNum.indexOf(\"016\") != 0 && telNum.indexOf(\"016\") != 1 &&\r\n              telNum.indexOf(\"011\") != 0 && telNum.indexOf(\"011\") != 1){                  \r\n            telNum = \"\";\r\n          }\r\n          if(telNum.length == 12){\r\n            telNum = telNum.substr(1, telNum.length);\r\n          }  \r\n        } \r\n        // 알림톡 발송이력\r\n        else {\r\n          custName = item.customer.custNm;\r\n          telNum = item.customer.custTelNo;\r\n          ttId = item.alarmTalkId.ttId;\r\n          svcMainClsCode = item.svcMainClsCode;                \r\n          sndNm = userInfoData.userName;   \r\n          sndTeam = userInfoData.deptName;\r\n        }                \r\n        \r\n        // 국가지역번호 처리        \r\n        if(telNum.indexOf(\"82\") == 0){          \r\n          telNum = \"0\" + telNum.substr(2, telNum.length);\r\n        }                 \r\n        this.oriCustNm = custName;\r\n        this.oriCustTelNo = telNum;\r\n        \r\n        // 고객명 전화번호 마스킹 처리\r\n        document.getElementById(\"targetName\").value = StringUtil.cusNmFormatter(custName);\r\n        document.getElementById(\"targetNum\").value = StringUtil.phoneFormatter(telNum);        \r\n        \r\n        this.ttId = ttId;\r\n        this.svcMainClsCode = svcMainClsCode;\r\n        this.sndNm = sndNm;\r\n        this.sndTeam = sndTeam;        \r\n\r\n      },\r\n      closeLayerPopup(){\r\n        document.getElementById(\"targetName\").disabled = true;\r\n        document.getElementById(\"targetNum\").disabled = true;\r\n        this.onLayer = false;\r\n      },\r\n      // 상담톡 화면에서 전송되어야함\r\n      sendAlarmTalk(){\r\n\r\n        // 유효성 검사 임시\r\n        let targetName = document.getElementById(\"targetName\");\r\n        let targetNum = document.getElementById(\"targetNum\");\r\n        \r\n        if(targetName.value == \"\"){\r\n          this.errorTxt = \"고객명은 필수 입력값입니다.\";\r\n          targetName.focus();\r\n          return false;\r\n        }\r\n        if(targetNum.value == \"\"){\r\n          this.errorTxt = \"전화번호는 필수 입력값입니다.\";\r\n          targetNum.focus();\r\n          return false;\r\n        }        \r\n\r\n        if(targetName.value.indexOf(\"*\") > -1){\r\n          this.custNm = this.oriCustNm;\r\n        } else {\r\n          this.custNm = targetName.value;\r\n        }\r\n        if(targetNum.value.indexOf(\"*\") > -1){\r\n          this.custTelNo = this.oriCustTelNo;\r\n        } else {\r\n          this.custTelNo = targetNum.value;\r\n        }\r\n\r\n        // 발송정보 스토리지 정보 셋팅\r\n        this.setStorageInfo();\r\n        this.$router.push({path:'/consult'});\r\n      },\r\n      setMenuOnToggle(num){\r\n        this.tabNum = num;\r\n      },\r\n      inputModify(target){\r\n        document.getElementById(target).disabled = false;\r\n      },\r\n      // 발송정보 스토리지 정보 셋팅\r\n      setStorageInfo(){\r\n        this.consultTarget.currTtID = this.ttId;\r\n        this.consultTarget.svcMainClsCode = this.svcMainClsCode;\r\n        this.consultTarget.sndNm = this.sndNm;\r\n        this.consultTarget.sndTeam = this.sndTeam;\r\n        this.consultTarget.targetName = this.custNm;\r\n        this.consultTarget.targetNum = this.custTelNo;\r\n        this.consultTarget.alarmSendCheck = 1;\r\n        /* #TODEL\r\n        localStorage.setItem('ttId', this.ttId);\r\n        localStorage.setItem('svcMainClsCode', this.svcMainClsCode);\r\n        localStorage.setItem('sndNm', this.sndNm);\r\n        localStorage.setItem('sndTeam', this.sndTeam);\r\n        localStorage.setItem('targetName', this.custNm);\r\n        localStorage.setItem('targetNum', this.custTelNo);\r\n        */\r\n      },\r\n      // 발송정보 스토리지 정보 삭제\r\n      removeStorageInfo(){\r\n        this.consultTarget.currTtID = \"\";\r\n        this.consultTarget.svcMainClsCode = \"\";\r\n        this.consultTarget.sndNm = \"\";\r\n        this.consultTarget.sndTeam = \"\";\r\n        this.consultTarget.targetName = \"\";\r\n        this.consultTarget.targetNum = \"\";\r\n        /* #TODEL\r\n        localStorage.removeItem(\"ttId\");\r\n        localStorage.removeItem(\"svcMainClsCode\");\r\n        localStorage.removeItem(\"sndNm\");\r\n        localStorage.removeItem(\"sndTeam\");\r\n        localStorage.removeItem(\"targetName\");\r\n        localStorage.removeItem(\"targetNum\");\r\n        */\r\n        // token 확인 진행\r\n        this.getRenewalToken();\r\n      },\r\n      getRenewalToken() {\r\n        // 토큰 갱신 확인 후 로직 진행\r\n        this.$store.dispatch(\"auth/renewalToken\").then(() => {     \r\n          if(!this.renewalToken.data){\r\n            alert(\"로그인이 만료되었습니다. 다시 로그인해주세요.\");\r\n            // localStorage 초기화\r\n            localStorage.clear();\r\n            // logout 호출\r\n            this.$store.dispatch(\"auth/signout\").then(() => {            \r\n              // 로그아웃 성공\r\n              this.$router.push({path:'/login'});\r\n            })\r\n            .catch(error => {\r\n              // 로그아웃 호출 실패. 로그인 페이지로 이동\r\n              console.log(error);\r\n              this.$router.push({path:'/login'});\r\n            });\r\n          }\r\n        })\r\n        \r\n      },               \r\n    },\r\n    mounted(){\r\n      //발송정보 스토리지 정보 삭제\r\n      this.removeStorageInfo();      \r\n    }\r\n  }\r\n</script>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}