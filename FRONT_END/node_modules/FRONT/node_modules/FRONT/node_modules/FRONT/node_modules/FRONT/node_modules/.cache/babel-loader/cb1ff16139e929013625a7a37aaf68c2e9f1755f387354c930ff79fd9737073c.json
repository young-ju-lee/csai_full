{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"C:/CSAI_Front/node_modules/@babel/runtime/helpers/interopRequireDefault.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.array.push.js\");\nvar _AlarmNATartgetList = _interopRequireDefault(require(\"./AlarmNATartgetList.vue\"));\nvar _AlarmSendHistList = _interopRequireDefault(require(\"./AlarmSendHistList.vue\"));\nvar _StringUtil = _interopRequireDefault(require(\"../../../utils/StringUtil\"));\n// AI 무출동 대상 조회\n// 알림톡 발송 이력\nvar _default = {\n  name: 'App',\n  data() {\n    return {\n      testPageNum: 1,\n      onLayer: false,\n      tabNum: 1,\n      errorTxt: \"\",\n      ttId: \"\",\n      svcMainClsCode: \"\",\n      sndNm: \"\",\n      sndTeam: \"\",\n      custNm: \"\",\n      custTelNo: \"\",\n      oriCustNm: \"\",\n      oriCustTelNo: \"\"\n    };\n  },\n  components: {\n    AlarmNATartgetList: _AlarmNATartgetList.default,\n    // AI 무출동 대상 조회\n    AlarmSendHistList: _AlarmSendHistList.default // 알림톡 발송 이력\n  },\n\n  computed: {\n    roomInfo() {\n      return this.$store.state.kakao.roomInfo;\n    },\n    userInfo() {\n      // 로그인 사용자 정보\n      return this.$store.state.auth.userInfo;\n    },\n    consultTarget() {\n      // 로그인 사용자 정보\n      return this.$store.state.consult.consultTarget;\n    },\n    renewalToken() {\n      return this.$store.state.auth.renewalToken;\n    }\n  },\n  created() {},\n  methods: {\n    setTestPageNum() {\n      this.testPageNum = this.testPageNum + 1;\n    },\n    openLayerPop(item) {\n      this.onLayer = true;\n      let userInfoData = this.userInfo; // 로그인한 사용자 정보        \n      let custName = '';\n      let reporterTelNum1 = '';\n      let reporterTelNum2 = '';\n      let telNum = '';\n      let ttId = '';\n      let svcMainClsCode = '';\n      let sndNm = '';\n      let sndTeam = '';\n      let tabNum = this.tabNum;\n      // 무출동 대상조회\n      if (tabNum == 1) {\n        custName = item.custName;\n        reporterTelNum1 = item.reporterTelNum1;\n        reporterTelNum2 = item.reporterTelNum2;\n        telNum = '';\n        ttId = item.ttId;\n        svcMainClsCode = item.svcMainClsCode;\n        sndNm = userInfoData.userName;\n        sndTeam = userInfoData.deptName;\n        if (reporterTelNum1 != \"\") {\n          if (reporterTelNum1.indexOf(\"010\") == 0 || reporterTelNum1.indexOf(\"010\") == 1 || reporterTelNum1.indexOf(\"017\") == 0 || reporterTelNum1.indexOf(\"017\") == 1 || reporterTelNum1.indexOf(\"016\") == 0 || reporterTelNum1.indexOf(\"016\") == 1 || reporterTelNum1.indexOf(\"011\") == 0 || reporterTelNum1.indexOf(\"011\") == 1) {\n            telNum = reporterTelNum1;\n          } else {\n            telNum = reporterTelNum2;\n          }\n        } else {\n          telNum = reporterTelNum2;\n        }\n        if (telNum.indexOf(\"010\") != 0 && telNum.indexOf(\"010\") != 1 && telNum.indexOf(\"017\") != 0 && telNum.indexOf(\"017\") != 1 && telNum.indexOf(\"016\") != 0 && telNum.indexOf(\"016\") != 1 && telNum.indexOf(\"011\") != 0 && telNum.indexOf(\"011\") != 1) {\n          telNum = \"\";\n        }\n        if (telNum.length == 12) {\n          telNum = telNum.substr(1, telNum.length);\n        }\n      }\n      // 알림톡 발송이력\n      else {\n        custName = item.customer.custNm;\n        telNum = item.customer.custTelNo;\n        ttId = item.alarmTalkId.ttId;\n        svcMainClsCode = item.svcMainClsCode;\n        sndNm = userInfoData.userName;\n        sndTeam = userInfoData.deptName;\n      }\n\n      // 국가지역번호 처리        \n      if (telNum.indexOf(\"82\") == 0) {\n        telNum = \"0\" + telNum.substr(2, telNum.length);\n      }\n      this.oriCustNm = custName;\n      this.oriCustTelNo = telNum;\n\n      // 고객명 전화번호 마스킹 처리\n      document.getElementById(\"targetName\").value = _StringUtil.default.cusNmFormatter(custName);\n      document.getElementById(\"targetNum\").value = _StringUtil.default.phoneFormatter(telNum);\n      this.ttId = ttId;\n      this.svcMainClsCode = svcMainClsCode;\n      this.sndNm = sndNm;\n      this.sndTeam = sndTeam;\n    },\n    closeLayerPopup() {\n      document.getElementById(\"targetName\").disabled = true;\n      document.getElementById(\"targetNum\").disabled = true;\n      this.onLayer = false;\n    },\n    // 상담톡 화면에서 전송되어야함\n    sendAlarmTalk() {\n      // 유효성 검사 임시\n      let targetName = document.getElementById(\"targetName\");\n      let targetNum = document.getElementById(\"targetNum\");\n      if (targetName.value == \"\") {\n        this.errorTxt = \"고객명은 필수 입력값입니다.\";\n        targetName.focus();\n        return false;\n      }\n      if (targetNum.value == \"\") {\n        this.errorTxt = \"전화번호는 필수 입력값입니다.\";\n        targetNum.focus();\n        return false;\n      }\n      if (targetName.value.indexOf(\"*\") > -1) {\n        this.custNm = this.oriCustNm;\n      } else {\n        this.custNm = targetName.value;\n      }\n      if (targetNum.value.indexOf(\"*\") > -1) {\n        this.custTelNo = this.oriCustTelNo;\n      } else {\n        this.custTelNo = targetNum.value;\n      }\n\n      // 발송정보 스토리지 정보 셋팅\n      this.setStorageInfo();\n      this.$router.push({\n        path: '/consult'\n      });\n    },\n    setMenuOnToggle(num) {\n      this.tabNum = num;\n    },\n    inputModify(target) {\n      document.getElementById(target).disabled = false;\n    },\n    // 발송정보 스토리지 정보 셋팅\n    setStorageInfo() {\n      this.consultTarget.currTtID = this.ttId;\n      this.consultTarget.svcMainClsCode = this.svcMainClsCode;\n      this.consultTarget.sndNm = this.sndNm;\n      this.consultTarget.sndTeam = this.sndTeam;\n      this.consultTarget.targetName = this.custNm;\n      this.consultTarget.targetNum = this.custTelNo;\n      this.consultTarget.alarmSendCheck = 1;\n      /* #TODEL\r\n      localStorage.setItem('ttId', this.ttId);\r\n      localStorage.setItem('svcMainClsCode', this.svcMainClsCode);\r\n      localStorage.setItem('sndNm', this.sndNm);\r\n      localStorage.setItem('sndTeam', this.sndTeam);\r\n      localStorage.setItem('targetName', this.custNm);\r\n      localStorage.setItem('targetNum', this.custTelNo);\r\n      */\n    },\n\n    // 발송정보 스토리지 정보 삭제\n    removeStorageInfo() {\n      this.consultTarget.currTtID = \"\";\n      this.consultTarget.svcMainClsCode = \"\";\n      this.consultTarget.sndNm = \"\";\n      this.consultTarget.sndTeam = \"\";\n      this.consultTarget.targetName = \"\";\n      this.consultTarget.targetNum = \"\";\n      /* #TODEL\r\n      localStorage.removeItem(\"ttId\");\r\n      localStorage.removeItem(\"svcMainClsCode\");\r\n      localStorage.removeItem(\"sndNm\");\r\n      localStorage.removeItem(\"sndTeam\");\r\n      localStorage.removeItem(\"targetName\");\r\n      localStorage.removeItem(\"targetNum\");\r\n      */\n      // token 확인 진행\n      this.getRenewalToken();\n    },\n    getRenewalToken() {\n      // 토큰 갱신 확인 후 로직 진행\n      this.$store.dispatch(\"auth/renewalToken\").then(() => {\n        if (!this.renewalToken.data) {\n          alert(\"로그인이 만료되었습니다. 다시 로그인해주세요.\");\n          // localStorage 초기화\n          localStorage.clear();\n          // logout 호출\n          this.$store.dispatch(\"auth/signout\").then(() => {\n            //23.10 로그아웃 or 페이지 종료시 로컬스토리지 초기화 \n            //this.$store.dispatch('select/doClearStateFromStorage'); \n            localStorage.values.clear();\n\n            // 로그아웃 성공              \n            this.$router.push({\n              path: '/login'\n            });\n          }).catch(error => {\n            // 로그아웃 호출 실패. 로그인 페이지로 이동\n            console.log(error);\n            this.$router.push({\n              path: '/login'\n            });\n          });\n        }\n      });\n    }\n  },\n  mounted() {\n    //발송정보 스토리지 정보 삭제\n    this.removeStorageInfo();\n  }\n};\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}