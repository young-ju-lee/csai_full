{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport AlarmNATartgetList from './AlarmNATartgetList.vue'; // AI 무출동 대상 조회\nimport AlarmSendHistList from './AlarmSendHistList.vue'; // 알림톡 발송 이력\nimport StringUtil from '../../../utils/StringUtil';\nexport default {\n  name: 'App',\n  data() {\n    return {\n      testPageNum: 1,\n      onLayer: false,\n      tabNum: 1,\n      errorTxt: \"\",\n      ttId: \"\",\n      svcMainClsCode: \"\",\n      sndNm: \"\",\n      sndTeam: \"\",\n      custNm: \"\",\n      custTelNo: \"\",\n      oriCustNm: \"\",\n      oriCustTelNo: \"\"\n    };\n  },\n  components: {\n    AlarmNATartgetList,\n    // AI 무출동 대상 조회\n    AlarmSendHistList // 알림톡 발송 이력\n  },\n\n  computed: {\n    roomInfo() {\n      return this.$store.state.kakao.roomInfo;\n    },\n    userInfo() {\n      // 로그인 사용자 정보\n      return this.$store.state.auth.userInfo;\n    },\n    consultTarget() {\n      // 로그인 사용자 정보\n      return this.$store.state.consult.consultTarget;\n    },\n    renewalToken() {\n      return this.$store.state.auth.renewalToken;\n    }\n  },\n  created() {},\n  methods: {\n    setTestPageNum() {\n      this.testPageNum = this.testPageNum + 1;\n    },\n    openLayerPop(item) {\n      this.onLayer = true;\n      let userInfoData = this.userInfo; // 로그인한 사용자 정보        \n      let custName = '';\n      let reporterTelNum1 = '';\n      let reporterTelNum2 = '';\n      let telNum = '';\n      let ttId = '';\n      let svcMainClsCode = '';\n      let sndNm = '';\n      let sndTeam = '';\n      let tabNum = this.tabNum;\n      // 무출동 대상조회\n      if (tabNum == 1) {\n        custName = item.custName;\n        reporterTelNum1 = item.reporterTelNum1;\n        reporterTelNum2 = item.reporterTelNum2;\n        telNum = '';\n        ttId = item.ttId;\n        svcMainClsCode = item.svcMainClsCode;\n        sndNm = userInfoData.userName;\n        sndTeam = userInfoData.deptName;\n        if (reporterTelNum1 != \"\") {\n          if (reporterTelNum1.indexOf(\"010\") == 0 || reporterTelNum1.indexOf(\"010\") == 1 || reporterTelNum1.indexOf(\"017\") == 0 || reporterTelNum1.indexOf(\"017\") == 1 || reporterTelNum1.indexOf(\"016\") == 0 || reporterTelNum1.indexOf(\"016\") == 1 || reporterTelNum1.indexOf(\"011\") == 0 || reporterTelNum1.indexOf(\"011\") == 1) {\n            telNum = reporterTelNum1;\n          } else {\n            telNum = reporterTelNum2;\n          }\n        } else {\n          telNum = reporterTelNum2;\n        }\n        if (telNum.indexOf(\"010\") != 0 && telNum.indexOf(\"010\") != 1 && telNum.indexOf(\"017\") != 0 && telNum.indexOf(\"017\") != 1 && telNum.indexOf(\"016\") != 0 && telNum.indexOf(\"016\") != 1 && telNum.indexOf(\"011\") != 0 && telNum.indexOf(\"011\") != 1) {\n          telNum = \"\";\n        }\n        if (telNum.length == 12) {\n          telNum = telNum.substr(1, telNum.length);\n        }\n      }\n      // 알림톡 발송이력\n      else {\n        custName = item.customer.custNm;\n        telNum = item.customer.custTelNo;\n        ttId = item.alarmTalkId.ttId;\n        svcMainClsCode = item.svcMainClsCode;\n        sndNm = userInfoData.userName;\n        sndTeam = userInfoData.deptName;\n      }\n\n      // 국가지역번호 처리        \n      if (telNum.indexOf(\"82\") == 0) {\n        telNum = \"0\" + telNum.substr(2, telNum.length);\n      }\n      this.oriCustNm = custName;\n      this.oriCustTelNo = telNum;\n\n      // 고객명 전화번호 마스킹 처리\n      document.getElementById(\"targetName\").value = StringUtil.cusNmFormatter(custName);\n      document.getElementById(\"targetNum\").value = StringUtil.phoneFormatter(telNum);\n      this.ttId = ttId;\n      this.svcMainClsCode = svcMainClsCode;\n      this.sndNm = sndNm;\n      this.sndTeam = sndTeam;\n    },\n    closeLayerPopup() {\n      document.getElementById(\"targetName\").disabled = true;\n      document.getElementById(\"targetNum\").disabled = true;\n      this.onLayer = false;\n    },\n    // 상담톡 화면에서 전송되어야함\n    sendAlarmTalk() {\n      // 유효성 검사 임시\n      let targetName = document.getElementById(\"targetName\");\n      let targetNum = document.getElementById(\"targetNum\");\n      if (targetName.value == \"\") {\n        this.errorTxt = \"고객명은 필수 입력값입니다.\";\n        targetName.focus();\n        return false;\n      }\n      if (targetNum.value == \"\") {\n        this.errorTxt = \"전화번호는 필수 입력값입니다.\";\n        targetNum.focus();\n        return false;\n      }\n      if (targetName.value.indexOf(\"*\") > -1) {\n        this.custNm = this.oriCustNm;\n      } else {\n        this.custNm = targetName.value;\n      }\n      if (targetNum.value.indexOf(\"*\") > -1) {\n        this.custTelNo = this.oriCustTelNo;\n      } else {\n        this.custTelNo = targetNum.value;\n      }\n\n      // 발송정보 스토리지 정보 셋팅\n      this.setStorageInfo();\n      this.$router.push({\n        path: '/consult'\n      });\n    },\n    setMenuOnToggle(num) {\n      this.tabNum = num;\n    },\n    inputModify(target) {\n      document.getElementById(target).disabled = false;\n    },\n    // 발송정보 스토리지 정보 셋팅\n    setStorageInfo() {\n      this.consultTarget.currTtID = this.ttId;\n      this.consultTarget.svcMainClsCode = this.svcMainClsCode;\n      this.consultTarget.sndNm = this.sndNm;\n      this.consultTarget.sndTeam = this.sndTeam;\n      this.consultTarget.targetName = this.custNm;\n      this.consultTarget.targetNum = this.custTelNo;\n      this.consultTarget.alarmSendCheck = 1;\n      /* #TODEL\r\n      localStorage.setItem('ttId', this.ttId);\r\n      localStorage.setItem('svcMainClsCode', this.svcMainClsCode);\r\n      localStorage.setItem('sndNm', this.sndNm);\r\n      localStorage.setItem('sndTeam', this.sndTeam);\r\n      localStorage.setItem('targetName', this.custNm);\r\n      localStorage.setItem('targetNum', this.custTelNo);\r\n      */\n    },\n\n    // 발송정보 스토리지 정보 삭제\n    removeStorageInfo() {\n      this.consultTarget.currTtID = \"\";\n      this.consultTarget.svcMainClsCode = \"\";\n      this.consultTarget.sndNm = \"\";\n      this.consultTarget.sndTeam = \"\";\n      this.consultTarget.targetName = \"\";\n      this.consultTarget.targetNum = \"\";\n      /* #TODEL\r\n      localStorage.removeItem(\"ttId\");\r\n      localStorage.removeItem(\"svcMainClsCode\");\r\n      localStorage.removeItem(\"sndNm\");\r\n      localStorage.removeItem(\"sndTeam\");\r\n      localStorage.removeItem(\"targetName\");\r\n      localStorage.removeItem(\"targetNum\");\r\n      */\n      // token 확인 진행\n      this.getRenewalToken();\n    },\n    getRenewalToken() {\n      // 토큰 갱신 확인 후 로직 진행\n      this.$store.dispatch(\"auth/renewalToken\").then(() => {\n        if (!this.renewalToken.data) {\n          alert(\"로그인이 만료되었습니다. 다시 로그인해주세요.\");\n          // localStorage 초기화\n          localStorage.clear();\n          // logout 호출\n          this.$store.dispatch(\"auth/signout\").then(() => {\n            // 로그아웃 성공\n            this.$router.push({\n              path: '/login'\n            });\n          }).catch(error => {\n            // 로그아웃 호출 실패. 로그인 페이지로 이동\n            console.log(error);\n            this.$router.push({\n              path: '/login'\n            });\n          });\n        }\n      });\n    }\n  },\n  mounted() {\n    //발송정보 스토리지 정보 삭제\n    this.removeStorageInfo();\n  }\n};","map":{"version":3,"mappings":"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","names":["AlarmNATartgetList","AlarmSendHistList","StringUtil","name","data","testPageNum","onLayer","tabNum","errorTxt","ttId","svcMainClsCode","sndNm","sndTeam","custNm","custTelNo","oriCustNm","oriCustTelNo","components","computed","roomInfo","$store","state","kakao","userInfo","auth","consultTarget","consult","renewalToken","created","methods","setTestPageNum","openLayerPop","item","userInfoData","custName","reporterTelNum1","reporterTelNum2","telNum","userName","deptName","indexOf","length","substr","customer","alarmTalkId","document","getElementById","value","cusNmFormatter","phoneFormatter","closeLayerPopup","disabled","sendAlarmTalk","targetName","targetNum","focus","setStorageInfo","$router","push","path","setMenuOnToggle","num","inputModify","target","currTtID","alarmSendCheck","removeStorageInfo","getRenewalToken","dispatch","then","alert","localStorage","clear","catch","error","console","log","mounted"],"sourceRoot":"","sources":["C:\\CSAI_Front\\src\\views\\pages\\alarm\\Alarm.vue"],"sourcesContent":["<template>\r\n    <!-- ct_03:인증 -->\r\n  <div class=\"contents\">\r\n    <div class=\"content_box\">\r\n      <div class=\"alarm\">\r\n        <div class=\"header_tab\">\r\n          <ul>\r\n            <li :class=\"tabNum == 1 ? 'on' : ''\" @click=\"setMenuOnToggle(1)\"><a href=\"#this\">AI 무출동 대상 조회</a></li>\r\n            <li :class=\"tabNum == 2 ? 'on' : ''\" @click=\"setMenuOnToggle(2)\"><a href=\"#this\">알림톡 발송 이력</a></li>\r\n          </ul>\r\n        </div>\r\n        <div>\r\n          <alarm-n-a-tartget-list @openLayerPop=\"openLayerPop\" v-if=\"tabNum == 1\" />\r\n          <alarm-send-hist-list @openLayerPop=\"openLayerPop\" v-if=\"tabNum == 2\" />\r\n        </div>\r\n        <!--// group -->\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"layer_popup\" v-show=\"onLayer\">\r\n    <div class=\"alarm_box\">\r\n      <h1>알림톡 발송 정보 입력</h1>\r\n      <div class=\"layer_box\">\r\n        <p class=\"fc_st02\">고장 접수된 고객명과 전화번호로 발송 가능하니<br>발송시 유의해 주시기 바랍니다.</p>\r\n        <dl class=\"dl_st_01\">\r\n          <dt><label for=\"user_id\">고객명</label></dt>\r\n          <dd>\r\n            <input type=\"text\" class=\"input_st_01\" id=\"targetName\" placeholder=\"고객명\" value=\"\" disabled>\r\n            <div class=\"input_ctl\">\r\n              <span class=\"modify\" @click=\"inputModify('targetName')\">수정</span>\r\n            </div>\r\n          </dd>\r\n        </dl>\r\n        <dl>\r\n          <dt><label for=\"user_pw\">전화번호</label></dt>\r\n          <dd>\r\n            <input type=\"text\"  class=\"input_st_01\" id=\"targetNum\" placeholder=\"전화번호\" value=\"\" disabled>\r\n            <div class=\"input_ctl\">\r\n              <span class=\"modify\" @click=\"inputModify('targetNum')\">수정</span>\r\n            </div>\r\n          </dd>\r\n        </dl>\r\n        <button @click=\"sendAlarmTalk()\">알림톡 발송</button>\r\n        <p class=\"error_txt\">{{errorTxt}}</p>\r\n      </div>\r\n      <p class=\"layer_close\" @click=\"closeLayerPopup()\"></p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import AlarmNATartgetList from './AlarmNATartgetList.vue'; // AI 무출동 대상 조회\r\n  import AlarmSendHistList from './AlarmSendHistList.vue'; // 알림톡 발송 이력\r\n  import StringUtil from '../../../utils/StringUtil';\r\n\r\n  export default {\r\n    name: 'App',\r\n    data() {\r\n      return {\r\n        testPageNum : 1,\r\n        onLayer : false,\r\n        tabNum : 1,\r\n        errorTxt : \"\",\r\n        ttId : \"\",\r\n        svcMainClsCode : \"\",\r\n        sndNm : \"\",\r\n        sndTeam : \"\",\r\n        custNm : \"\",\r\n        custTelNo : \"\",\r\n        oriCustNm : \"\",\r\n        oriCustTelNo : \"\"\r\n      }\r\n    },\r\n    components: {\r\n      AlarmNATartgetList, // AI 무출동 대상 조회\r\n      AlarmSendHistList, // 알림톡 발송 이력\r\n    },\r\n    computed: {\r\n      roomInfo() {\r\n        return this.$store.state.kakao.roomInfo;\r\n      },\r\n      userInfo() {\r\n      // 로그인 사용자 정보\r\n        return this.$store.state.auth.userInfo;\r\n      },\r\n      consultTarget() {\r\n      // 로그인 사용자 정보\r\n        return this.$store.state.consult.consultTarget;\r\n      },\r\n      renewalToken(){\r\n        return this.$store.state.auth.renewalToken;\r\n      }\r\n    },\r\n    created() {\r\n    },\r\n    methods: {\r\n      setTestPageNum() {\r\n        this.testPageNum = this.testPageNum + 1;\r\n      },\r\n      openLayerPop(item){\r\n                \r\n        this.onLayer = true;\r\n        let userInfoData = this.userInfo;  // 로그인한 사용자 정보        \r\n        let custName = '';\r\n        let reporterTelNum1 = '';\r\n        let reporterTelNum2 = '';\r\n        let telNum = '';\r\n        let ttId = '';\r\n        let svcMainClsCode = '';\r\n        let sndNm = '';\r\n        let sndTeam = '';\r\n        let tabNum = this.tabNum;        \r\n        // 무출동 대상조회\r\n        if(tabNum == 1){\r\n          custName = item.custName;\r\n          reporterTelNum1 = item.reporterTelNum1;\r\n          reporterTelNum2 = item.reporterTelNum2;\r\n          telNum = '';\r\n          ttId = item.ttId;\r\n          svcMainClsCode = item.svcMainClsCode;\r\n          sndNm = userInfoData.userName;   \r\n          sndTeam = userInfoData.deptName;\r\n          if(reporterTelNum1 != \"\"){                                \r\n            if(reporterTelNum1.indexOf(\"010\") == 0 || reporterTelNum1.indexOf(\"010\") == 1 || \r\n                reporterTelNum1.indexOf(\"017\") == 0 || reporterTelNum1.indexOf(\"017\") == 1 ||\r\n                reporterTelNum1.indexOf(\"016\") == 0 || reporterTelNum1.indexOf(\"016\") == 1 ||\r\n                reporterTelNum1.indexOf(\"011\") == 0 || reporterTelNum1.indexOf(\"011\") == 1){                  \r\n              telNum = reporterTelNum1;\r\n            } else {\r\n              telNum = reporterTelNum2;                             \r\n            }\r\n          } else {\r\n            telNum = reporterTelNum2;                        \r\n          }\r\n          \r\n          if(telNum.indexOf(\"010\") != 0 && telNum.indexOf(\"010\") != 1 &&\r\n              telNum.indexOf(\"017\") != 0 && telNum.indexOf(\"017\") != 1 &&\r\n              telNum.indexOf(\"016\") != 0 && telNum.indexOf(\"016\") != 1 &&\r\n              telNum.indexOf(\"011\") != 0 && telNum.indexOf(\"011\") != 1){                  \r\n            telNum = \"\";\r\n          }\r\n          if(telNum.length == 12){\r\n            telNum = telNum.substr(1, telNum.length);\r\n          }  \r\n        } \r\n        // 알림톡 발송이력\r\n        else {\r\n          custName = item.customer.custNm;\r\n          telNum = item.customer.custTelNo;\r\n          ttId = item.alarmTalkId.ttId;\r\n          svcMainClsCode = item.svcMainClsCode;                \r\n          sndNm = userInfoData.userName;   \r\n          sndTeam = userInfoData.deptName;\r\n        }                \r\n        \r\n        // 국가지역번호 처리        \r\n        if(telNum.indexOf(\"82\") == 0){          \r\n          telNum = \"0\" + telNum.substr(2, telNum.length);\r\n        }                 \r\n        this.oriCustNm = custName;\r\n        this.oriCustTelNo = telNum;\r\n        \r\n        // 고객명 전화번호 마스킹 처리\r\n        document.getElementById(\"targetName\").value = StringUtil.cusNmFormatter(custName);\r\n        document.getElementById(\"targetNum\").value = StringUtil.phoneFormatter(telNum);        \r\n        \r\n        this.ttId = ttId;\r\n        this.svcMainClsCode = svcMainClsCode;\r\n        this.sndNm = sndNm;\r\n        this.sndTeam = sndTeam;        \r\n\r\n      },\r\n      closeLayerPopup(){\r\n        document.getElementById(\"targetName\").disabled = true;\r\n        document.getElementById(\"targetNum\").disabled = true;\r\n        this.onLayer = false;\r\n      },\r\n      // 상담톡 화면에서 전송되어야함\r\n      sendAlarmTalk(){\r\n\r\n        // 유효성 검사 임시\r\n        let targetName = document.getElementById(\"targetName\");\r\n        let targetNum = document.getElementById(\"targetNum\");\r\n        \r\n        if(targetName.value == \"\"){\r\n          this.errorTxt = \"고객명은 필수 입력값입니다.\";\r\n          targetName.focus();\r\n          return false;\r\n        }\r\n        if(targetNum.value == \"\"){\r\n          this.errorTxt = \"전화번호는 필수 입력값입니다.\";\r\n          targetNum.focus();\r\n          return false;\r\n        }        \r\n\r\n        if(targetName.value.indexOf(\"*\") > -1){\r\n          this.custNm = this.oriCustNm;\r\n        } else {\r\n          this.custNm = targetName.value;\r\n        }\r\n        if(targetNum.value.indexOf(\"*\") > -1){\r\n          this.custTelNo = this.oriCustTelNo;\r\n        } else {\r\n          this.custTelNo = targetNum.value;\r\n        }\r\n\r\n        // 발송정보 스토리지 정보 셋팅\r\n        this.setStorageInfo();\r\n        this.$router.push({path:'/consult'});\r\n      },\r\n      setMenuOnToggle(num){\r\n        this.tabNum = num;\r\n      },\r\n      inputModify(target){\r\n        document.getElementById(target).disabled = false;\r\n      },\r\n      // 발송정보 스토리지 정보 셋팅\r\n      setStorageInfo(){\r\n        this.consultTarget.currTtID = this.ttId;\r\n        this.consultTarget.svcMainClsCode = this.svcMainClsCode;\r\n        this.consultTarget.sndNm = this.sndNm;\r\n        this.consultTarget.sndTeam = this.sndTeam;\r\n        this.consultTarget.targetName = this.custNm;\r\n        this.consultTarget.targetNum = this.custTelNo;\r\n        this.consultTarget.alarmSendCheck = 1;\r\n        /* #TODEL\r\n        localStorage.setItem('ttId', this.ttId);\r\n        localStorage.setItem('svcMainClsCode', this.svcMainClsCode);\r\n        localStorage.setItem('sndNm', this.sndNm);\r\n        localStorage.setItem('sndTeam', this.sndTeam);\r\n        localStorage.setItem('targetName', this.custNm);\r\n        localStorage.setItem('targetNum', this.custTelNo);\r\n        */\r\n      },\r\n      // 발송정보 스토리지 정보 삭제\r\n      removeStorageInfo(){\r\n        this.consultTarget.currTtID = \"\";\r\n        this.consultTarget.svcMainClsCode = \"\";\r\n        this.consultTarget.sndNm = \"\";\r\n        this.consultTarget.sndTeam = \"\";\r\n        this.consultTarget.targetName = \"\";\r\n        this.consultTarget.targetNum = \"\";\r\n        /* #TODEL\r\n        localStorage.removeItem(\"ttId\");\r\n        localStorage.removeItem(\"svcMainClsCode\");\r\n        localStorage.removeItem(\"sndNm\");\r\n        localStorage.removeItem(\"sndTeam\");\r\n        localStorage.removeItem(\"targetName\");\r\n        localStorage.removeItem(\"targetNum\");\r\n        */\r\n        // token 확인 진행\r\n        this.getRenewalToken();\r\n      },\r\n      getRenewalToken() {\r\n        // 토큰 갱신 확인 후 로직 진행\r\n        this.$store.dispatch(\"auth/renewalToken\").then(() => {     \r\n          if(!this.renewalToken.data){\r\n            alert(\"로그인이 만료되었습니다. 다시 로그인해주세요.\");\r\n            // localStorage 초기화\r\n            localStorage.clear();\r\n            // logout 호출\r\n            this.$store.dispatch(\"auth/signout\").then(() => {            \r\n              // 로그아웃 성공\r\n              this.$router.push({path:'/login'});\r\n            })\r\n            .catch(error => {\r\n              // 로그아웃 호출 실패. 로그인 페이지로 이동\r\n              console.log(error);\r\n              this.$router.push({path:'/login'});\r\n            });\r\n          }\r\n        })\r\n        \r\n      },               \r\n    },\r\n    mounted(){\r\n      //발송정보 스토리지 정보 삭제\r\n      this.removeStorageInfo();      \r\n    }\r\n  }\r\n</script>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}